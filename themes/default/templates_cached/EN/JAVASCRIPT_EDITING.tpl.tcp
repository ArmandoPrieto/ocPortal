<?php
return unserialize("a:6:{i:0;a:1:{i:0;a:5:{i:0;s:26:\"tcpfunc_JAVASCRIPT_EDITING\";i:1;a:0:{}i:2;i:1;i:3;s:0:\"\";i:4;s:0:\"\";}}i:1;a:0:{}i:2;s:18:\"JAVASCRIPT_EDITING\";i:3;N;i:4;N;i:5;s:34124:\"\$TPL_FUNCS['tcpfunc_JAVASCRIPT_EDITING']=\" echo \\\"/* Form editing code (general\\\",\\n	',',\\n	\\\" may be used on many different kinds of form) */\\\\n\\\\n// ===========\\\\n// HTML EDITOR\\\\n// ===========\\\\n\\\\nfunction wysiwyg_on()\\\\n{\\\\n	var cookie=ReadCookie('use_wysiwyg');\\\\n	return ((cookie=='') || (cookie=='1')) && (browser_matches('wysiwyg') && ('\\\",\\n	ecv(\\\$cl,array(),0,\\\"MOBILE\\\",array()),\\n	\\\"'!='_true'));\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction toggle_wysiwyg(name)\\\\n{\\\\n	if (!browser_matches('wysiwyg'))\\\\n	{\\\\n		window.alert('\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"TOGGLE_WYSIWYG_ERROR\\\",array()),\\n	\\\"');\\\\n		return false;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	if (typeof window.load_XML_doc=='undefined') return false;\\\\n	if (typeof window.merge_text_nodes=='undefined') return false;\\\\n	if (typeof window.get_elements_by_class_name=='undefined') return false;\\\\n\\\\n	var is_wysiwyg_on=wysiwyg_on();\\\\n	var saving_cookies=!is_wysiwyg_on || window.confirm('\\\",\\n	ecv(\\\$cl,array(2),2,\\\"WHETHER_SAVE_WYSIWYG_SELECTION\\\",array()),\\n	\\\"');\\\\n	if (saving_cookies)\\\\n	{\\\\n		SetCookie('use_wysiwyg'\\\",\\n	',',\\n	\\\"is_wysiwyg_on?'0':'1'\\\",\\n	',',\\n	\\\"3000);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	var forms=document.getElementsByTagName('form');\\\\n	var counter\\\",\\n	',',\\n	\\\"id;\\\\n	var so=document.getElementById('post_special_options');\\\\n	var so2=document.getElementById('post_special_options2');\\\\n\\\\n	var request\\\",\\n	',',\\n	\\\"result;\\\\n	if (is_wysiwyg_on)\\\\n	{\\\\n		// Find if the WYSIWYG has anything in it - if not\\\",\\n	',',\\n	\\\" discard\\\\n		var all_empty=true\\\",\\n	',',\\n	\\\"myregexp=new RegExp(/((\\\\\\\\s)|(<p\\\\\\\\d*\\\\\\\\/>)|(<\\\\\\\\/p>)|(<p>)|(&nbsp;)|(<br[^>]*>))*/);\\\\n		for (var fid=0;fid<forms.length;fid++)\\\\n		{\\\\n			for (counter=0;counter<forms[fid].elements.length;counter++)\\\\n			{\\\\n				id=forms[fid].elements[counter].id;\\\\n				if (typeof window.areaedit_editors[id]!='undefined')\\\\n				{\\\\n					if (window.areaedit_editors[id].getData().replace(myregexp\\\",\\n	',',\\n	\\\"'')!='') all_empty=false;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n		// If we do not need to prompt\\\",\\n	',',\\n	\\\" hard coded it with the \\\\\\\"discard\\\\\\\" line text\\\",\\n	',',\\n	\\\" else make real prompt\\\\n		var prompt=all_empty?'\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES_LINE\\\",array()),\\n	\\\"':generate_question_ui('\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES_NICE\\\",array()),\\n	\\\"'\\\",\\n	',',\\n	\\\"{cancel: '\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"INPUTSYSTEM_CANCEL\\\",array()),\\n	\\\"'\\\",\\n	',',\\n	\\\"convert: '\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES_LINE_CONVERT\\\",array()),\\n	\\\"'\\\",\\n	',',\\n	\\\"discard: '\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES_LINE\\\",array()),\\n	\\\"'\\\",\\n	\\\"}\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISABLE_WYSIWYG\\\",array()),\\n	\\\"'\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES\\\",array()),\\n	\\\"');\\\\n		if ((!prompt) || (prompt.toLowerCase()=='\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"INPUTSYSTEM_CANCEL\\\",array()),\\n	\\\"'.toLowerCase()))\\\\n		{\\\\n			if (saving_cookies)\\\\n				SetCookie('use_wysiwyg'\\\",\\n	',',\\n	\\\"'1'\\\",\\n	',',\\n	\\\"3000);\\\\n			return false;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		var discard=(prompt.toLowerCase()=='\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISCARD_WYSIWYG_CHANGES_LINE\\\",array()),\\n	\\\"'.toLowerCase());\\\\n\\\\n		for (var fid=0;fid<forms.length;fid++)\\\\n		{\\\\n			for (counter=0;counter<forms[fid].elements.length;counter++)\\\\n			{\\\\n				id=forms[fid].elements[counter].id;\\\\n				if (typeof window.areaedit_editors[id]!='undefined')\\\\n				{\\\\n					var textarea=forms[fid].elements[counter];\\\\n\\\\n					// Mark as non-WYSIWYG\\\\n					document.getElementById(id+'__is_wysiwyg').value='0';\\\\n					textarea.style.display='block';\\\\n					textarea.style.visibility='visible';\\\\n					textarea.disabled=false;\\\\n					textarea.readOnly=false;\\\\n\\\\n					// Comcode conversion\\\\n					if ((discard) && (window.areaedit_original_comcode[id]))\\\\n					{\\\\n						textarea.value=window.areaedit_original_comcode[id];\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n					{\\\\n						request=load_XML_doc('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT_NOHTTP\\\",array(\\\"comcode_convert\\\")),\\n	\\\"?from_html=1'+keep_stub()\\\",\\n	',',\\n	\\\"false\\\",\\n	',',\\n	\\\"'data='+window.encodeURIComponent(window.areaedit_editors[id].getData()));\\\\n						if ((!request.responseXML) || (!request.responseXML.documentElement.getElementsByTagName(\\\\\\\"result\\\\\\\")[0]))\\\\n						{\\\\n							textarea.value='[semihtml]'+areaedit_editors[id].getData()+'[/semihtml]';\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n						{\\\\n							var result_tags=request.responseXML.documentElement.getElementsByTagName(\\\\\\\"result\\\\\\\");\\\\n							result=result_tags[0];\\\\n							textarea.value=merge_text_nodes(result.childNodes).replace(/\\\\\\\\s*\\\\\\\$/\\\",\\n	',',\\n	\\\"'');\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n						if ((textarea.value.indexOf('{\\\\\\\\\\\\\\\$\\\",\\n	',',\\n	\\\"page hint: no_wysiwyg\\\",\\n	\\\"}\\\",\\n	\\\"')==-1) && (textarea.value!='')) textarea.value+='{\\\\\\\\\\\\\\\$\\\",\\n	',',\\n	\\\"page hint: no_wysiwyg\\\",\\n	\\\"}\\\",\\n	\\\"';\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					if (document.getElementById('toggle_wysiwyg_'+id))\\\\n						setInnerHTML(document.getElementById('toggle_wysiwyg_'+id)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"ENABLE_WYSIWYG\\\",array()),\\n	\\\"');\\\\n\\\\n					// Unload editor\\\\n					window.areaedit_editors[id].elementMode=CKEDITOR.ELEMENT_MODE_NONE;\\\\n					CKEDITOR.remove(window.areaedit_editors[id]);\\\\n					delete window.areaedit_editors[id];\\\\n					var wysiwyg_node=document.getElementById('cke_'+id);\\\\n					wysiwyg_node.parentNode.removeChild(wysiwyg_node);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		if (so) so.style.display='block';\\\\n		if (so2) so2.style.display='none';\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		if (so) so.style.display='none';\\\\n		if (so2) so2.style.display='block';\\\\n\\\\n		for (var fid=0;fid<forms.length;fid++)\\\\n		{\\\\n			load_html_edit(forms[fid]\\\",\\n	',',\\n	\\\"true);\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	return false;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nvar areaedit_editors=[];\\\\nvar areaedit_original_comcode=[];\\\\nfunction load_html_edit(posting_form\\\",\\n	',',\\n	\\\"ajax_copy)\\\\n{\\\\n	if (typeof window._editor_url=='undefined') return; \\\",\\n	\\\"\\\\n\\\\n	if ((!posting_form.getAttribute('method')) || (posting_form.getAttribute('method').toLowerCase()!='post')) return;\\\\n	\\\\n	if (!posting_form.elements['http_referer'])\\\\n	{\\\\n		var http_referer=document.createElement('input');\\\\n		http_referer.name='http_referer';\\\\n		http_referer.value=window.location.href;\\\\n		http_referer.setAttribute('type'\\\",\\n	',',\\n	\\\"'hidden');\\\\n		posting_form.appendChild(http_referer);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\\n	if (typeof window.load_XML_doc=='undefined') return;\\\\n	if (typeof window.merge_text_nodes=='undefined') return;\\\\n	if (typeof window.CKEDITOR=='undefined') return;\\\\n	if (!browser_matches('wysiwyg')) return;\\\\n	if (!wysiwyg_on()) return;\\\\n\\\\n	var so=document.getElementById('post_special_options');\\\\n	var so2=document.getElementById('post_special_options2');\\\\n	if ((!posting_form.elements['post']) || (posting_form.elements['post'].className.indexOf('wysiwyg')!=-1))\\\\n	{\\\\n		if (so) so.style.display='none';\\\\n		if (so2) so2.style.display='block';\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	var counter\\\",\\n	',',\\n	\\\"count=0\\\",\\n	',',\\n	\\\"e\\\",\\n	',',\\n	\\\"indicator\\\",\\n	',',\\n	\\\"those_done=[]\\\",\\n	',',\\n	\\\"result\\\",\\n	',',\\n	\\\"request\\\",\\n	',',\\n	\\\"id;\\\\n	for (counter=0;counter<posting_form.elements.length;counter++)\\\\n	{\\\\n		e=posting_form.elements[counter];\\\\n		id=e.id;\\\\n\\\\n		if ((e.type=='textarea') && (e.className.indexOf('wysiwyg')!=-1) && (!is_comcode_xml(e)))\\\\n		{\\\\n			if (document.getElementById(id+'__is_wysiwyg'))\\\\n			{\\\\n				indicator=document.getElementById(id+'__is_wysiwyg');\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				indicator=document.createElement('input');\\\\n				indicator.setAttribute('type'\\\",\\n	',',\\n	\\\"'hidden');\\\\n				indicator.id=e.id+'__is_wysiwyg';\\\\n				indicator.name=e.name+'__is_wysiwyg';\\\\n				posting_form.appendChild(indicator);\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			indicator.value='1';\\\\n\\\\n			if (those_done[id]) continue;\\\\n			those_done[id]=1;\\\\n\\\\n			count++;\\\\n			if (document.getElementById('toggle_wysiwyg_'+id))\\\\n				setInnerHTML(document.getElementById('toggle_wysiwyg_'+id)\\\",\\n	',',\\n	\\\"'\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"DISABLE_WYSIWYG\\\",array()),\\n	\\\"');\\\\n\\\\n			window.areaedit_original_comcode[id]=e.value;\\\\n			if (!ajax_copy)\\\\n			{\\\\n				if ((typeof posting_form.elements[id+\\\\\\\"_parsed\\\\\\\"]!='undefined') && (posting_form.elements[id+\\\\\\\"_parsed\\\\\\\"].value!='') && (e.defaultValue==e.value)) // The extra conditionals are for if back button used\\\\n					e.value=posting_form.elements[id+\\\\\\\"_parsed\\\\\\\"].value;\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				request=load_XML_doc('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT_NOHTTP\\\",array(\\\"comcode_convert\\\")),\\n	\\\"?semihtml=1&from_html=0'+keep_stub()\\\",\\n	',',\\n	\\\"false\\\",\\n	',',\\n	\\\"'data='+window.encodeURIComponent(posting_form.elements[counter].value));\\\\n				if (!request.responseXML)\\\\n				{\\\\n					posting_form.elements[counter].value='';\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n				{\\\\n					var result_tags=request.responseXML.documentElement.getElementsByTagName(\\\\\\\"result\\\\\\\");\\\\n					if ((!result_tags) || (result_tags.length==0))\\\\n					{\\\\n						posting_form.elements[counter].value='';\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n					{\\\\n						result=result_tags[0];\\\\n						posting_form.elements[counter].value=merge_text_nodes(result.childNodes);\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			window.setTimeout(function(e\\\",\\n	',',\\n	\\\"id) {\\\\n				return function() {\\\\n					window.areaedit_editors[id]=areaedit_init(e);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"(e\\\",\\n	',',\\n	\\\"id)\\\",\\n	',',\\n	\\\"1000);\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	if (count==0) return;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction areaedit_init(element)\\\\n{\\\\n	var pageStyleSheets=[];\\\\n	var linked_sheets=document.getElementsByTagName('link');\\\\n	for (counter=0;counter<linked_sheets.length;counter++)\\\\n	{\\\\n		if (linked_sheets[counter].getAttribute('rel')=='stylesheet')\\\\n			pageStyleSheets.push(linked_sheets[counter].getAttribute('href'));\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	// Fiddly procedure to find our colour\\\\n	var test_div=document.createElement('div');\\\\n	document.body.appendChild(test_div);\\\\n	test_div.className='wysiwyg_color_finder';\\\\n	var wysiwyg_color=abstractGetComputedStyle(test_div\\\",\\n	',',\\n	\\\"'color');\\\\n	test_div.parentNode.removeChild(test_div);\\\\n\\\\n	var editor=CKEDITOR.replace(element.id\\\",\\n	',',\\n	\\\" {\\\\n		enterMode : CKEDITOR.ENTER_BR\\\",\\n	',',\\n	\\\"\\\\n		uiColor : wysiwyg_color\\\",\\n	',',\\n	\\\"\\\\n		fontSize_sizes : '0.6em;0.85em;1em;1.1em;1.2em;1.3em;1.4em;1.5em;1.6em;1.7em;1.8em;2em'\\\",\\n	',',\\n	\\\"\\\\n		removePlugins: 'smiley\\\",\\n	',',\\n	\\\"uicolor\\\",\\n	',',\\n	\\\"contextmenu'\\\",\\n	',',\\n	\\\"\\\\n		customConfig : ''\\\",\\n	',',\\n	\\\"\\\\n		bodyId : 'htmlarea'\\\",\\n	',',\\n	\\\"\\\\n		baseHref : get_base_url()\\\",\\n	',',\\n	\\\"\\\\n		linkShowAdvancedTab : false\\\",\\n	',',\\n	\\\"\\\\n		imageShowAdvancedTab : false\\\",\\n	',',\\n	\\\"\\\\n		imageShowLinkTab : false\\\",\\n	',',\\n	\\\"\\\\n		autoUpdateElement : true\\\",\\n	',',\\n	\\\"\\\\n		contentsCss : pageStyleSheets\\\",\\n	',',\\n	\\\"\\\\n		cssStatic : css\\\",\\n	',',\\n	\\\"\\\\n		language : _editor_lang\\\",\\n	',',\\n	\\\"\\\\n		emailProtection : false\\\",\\n	',',\\n	\\\"\\\\n		resize_enabled : true\\\",\\n	',',\\n	\\\"\\\\n		width : findWidth(element)\\\",\\n	',',\\n	\\\"\\\\n		height : (window.location.href.indexOf('cms_comcode_pages')==-1)?250:500\\\",\\n	',',\\n	\\\"\\\\n		\\\",\\n	(in_array(ecv(\\\$cl,array(),0,\\\"NOT\\\",array(ecv(\\\$cl,array(),0,\\\"VALUE_OPTION\\\",array(\\\"commercial_spellchecker\\\")))).\\\"\\\",\\\$GLOBALS['TRUTH_PARAMETERS'])?(\\\"\\\\n			disableNativeSpellChecker : false\\\".','.\\\"\\\\n		\\\"):''),\\n	\\\"\\\\n		toolbar : [\\\\n			['Source'\\\",\\n	',',\\n	\\\"'-']\\\",\\n	',',\\n	\\\"\\\\n			['Cut'\\\",\\n	',',\\n	\\\"'Copy'\\\",\\n	',',\\n	\\\"'Paste'\\\",\\n	',',\\n	\\\"'PasteText'\\\",\\n	',',\\n	\\\"'PasteFromWord'\\\",\\n	(in_array(ecv(\\\$cl,array(),0,\\\"VALUE_OPTION\\\",array(\\\"commercial_spellchecker\\\")).\\\"\\\",\\\$GLOBALS['TRUTH_PARAMETERS'])?(','.\\\"'-'\\\".','.\\\"'SpellChecker'\\\".','.\\\" 'Scayt'\\\"):''),\\n	\\\"]\\\",\\n	',',\\n	\\\"\\\\n			['Undo'\\\",\\n	',',\\n	\\\"'Redo'\\\",\\n	',',\\n	\\\"'-'\\\",\\n	',',\\n	\\\"'Find'\\\",\\n	',',\\n	\\\"'Replace'\\\",\\n	',',\\n	\\\"'-'\\\",\\n	',',\\n	\\\"'SelectAll'\\\",\\n	',',\\n	\\\"'RemoveFormat']\\\",\\n	',',\\n	\\\"\\\\n			['Link'\\\",\\n	',',\\n	\\\"'Unlink']\\\",\\n	',',\\n	\\\"\\\\n			'/'\\\",\\n	',',\\n	\\\"\\\\n			['Bold'\\\",\\n	',',\\n	\\\"'Italic'\\\",\\n	',',\\n	\\\"'Strike'\\\",\\n	',',\\n	\\\"'-'\\\",\\n	',',\\n	\\\"'Subscript'\\\",\\n	',',\\n	\\\"'Superscript']\\\",\\n	',',\\n	\\\"\\\\n			['NumberedList'\\\",\\n	',',\\n	\\\"'BulletedList'\\\",\\n	',',\\n	\\\"'-'\\\",\\n	',',\\n	\\\"'Outdent'\\\",\\n	',',\\n	\\\"'Indent']\\\",\\n	',',\\n	\\\"\\\\n			['JustifyLeft'\\\",\\n	',',\\n	\\\"'JustifyCenter'\\\",\\n	',',\\n	\\\"'JustifyRight'\\\",\\n	',',\\n	\\\"'JustifyBlock']\\\",\\n	',',\\n	\\\"\\\\n			['Image'\\\",\\n	',',\\n	\\\"'Table']\\\",\\n	',',\\n	\\\"\\\\n			'/'\\\",\\n	',',\\n	\\\"\\\\n			['Format'\\\",\\n	',',\\n	\\\"'Font'\\\",\\n	',',\\n	\\\"'FontSize']\\\",\\n	',',\\n	\\\"\\\\n			['TextColor']\\\",\\n	',',\\n	\\\"\\\\n			['Maximize'\\\",\\n	',',\\n	\\\" 'ShowBlocks']\\\",\\n	',',\\n	\\\"\\\\n			['HorizontalRule'\\\",\\n	',',\\n	\\\"'SpecialChar']\\\\n		]\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" );\\\\n\\\\n	linked_sheets=document.getElementsByTagName('style');\\\\n	var css='';\\\\n	var global_div=document.getElementById('global_div');\\\\n	if (global_div) css='body { background-color: '+abstractGetComputedStyle(global_div\\\",\\n	',',\\n	\\\"'background-color')+' !important; \\\",\\n	\\\"}\\\",\\n	\\\"';\\\\n	css+='body { width: 100%; min-height: 140px; \\\",\\n	\\\"}\\\",\\n	\\\"'; // IE9 selectability fix\\\\n	css+=\\\\\\\"#main_page_title { display: block !important \\\",\\n	\\\"}\\\",\\n	\\\"\\\\\\\";\\\\n	css+=\\\\\\\".MsoNormal { margin: 0; \\\",\\n	\\\"}\\\",\\n	\\\"\\\\\\\";\\\\n	css+='.ocp_keep\\\",\\n	',',\\n	\\\" .ocp_keep_block { font-weight: bold; background-color: #BABAFF; \\\",\\n	\\\"}\\\",\\n	\\\"';\\\\n	//css+='.ocp_keep_block[tag=\\\\\\\"block\\\\\\\"] { display: block; padding: 30px 0; text-align: center; \\\",\\n	\\\"}\\\",\\n	\\\"';  Cutting and pasting becomes dodgy if this is enabled\\\\n	css+='.comcode_fake_table > div\\\",\\n	',',\\n	\\\" .fp_col_block { outline: 1px dotted; margin: 1px 0; \\\",\\n	\\\"}\\\",\\n	\\\"';\\\\n	for (counter=0;counter<linked_sheets.length;counter++)\\\\n	{\\\\n		css+=getInnerHTML(linked_sheets[counter]);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	editor.addCss(css);\\\\n\\\\n	window.setTimeout( function() {\\\\n		window.scrollTo(0\\\",\\n	',',\\n	\\\"0); // Otherwise jumps to last editor\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" \\\",\\n	',',\\n	\\\" 500);\\\\n\\\\n	editor.on('key'\\\",\\n	',',\\n	\\\" function (event) {\\\\n		if (typeof element.externalonKeyPress!='undefined')\\\\n		{\\\\n			element.value=editor.getData();\\\\n			element.externalonKeyPress(event\\\",\\n	',',\\n	\\\"element);\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" );\\\\n\\\\n	editor.on('instanceReady'\\\",\\n	',',\\n	\\\" function (event) {\\\\n		findTagsInEditor(editor\\\",\\n	',',\\n	\\\"element);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" );\\\\n	window.setInterval(function() {\\\\n		if (isWYSIWYGField(element))\\\\n			findTagsInEditor(editor\\\",\\n	',',\\n	\\\"element);\\\\n	\\\",\\n	\\\"}\\\",\\n	',',\\n	\\\" 1000);\\\\n\\\\n	// Weird issues in Chrome cutting+pasting blocks etc\\\\n	editor.on('paste'\\\",\\n	',',\\n	\\\" function (event) {\\\\n		if (event.data.html)\\\\n		{\\\\n			event.data.html=event.data.html.replace(/<meta charset=\\\\\\\"utf-8\\\\\\\">/g\\\",\\n	',',\\n	\\\"'');\\\\n			event.data.html=event.data.html.replace(/<br class=\\\\\\\"Apple-interchange-newline\\\\\\\">/g\\\",\\n	',',\\n	\\\"'<br>');\\\\n			event.data.html=event.data.html.replace(/<div style=\\\\\\\"text-align: center;\\\\\\\"><font class=\\\\\\\"Apple-style-span\\\\\\\" face=\\\\\\\"'Lucida Grande'\\\\\\\"><span class=\\\\\\\"Apple-style-span\\\\\\\" style=\\\\\\\"font-size: 11px; white-space: pre;\\\\\\\"><br><\\\\\\\\/span><\\\\\\\\/font><\\\\\\\\/div>\\\\\\\$/\\\",\\n	',',\\n	\\\"'<br><br>');\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" );\\\\n\\\\n	/*editor.on('instanceReady'\\\",\\n	',',\\n	\\\"function(ev) Does not work\\\\n	{\\\\n		var editor = ev.editor;\\\\n		if (typeof window.initialise_dragdrop_upload!='undefined') initialise_dragdrop_upload(element.id\\\",\\n	',',\\n	\\\"element.id\\\",\\n	',',\\n	\\\"editor.element.\\\\\\\$.document);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\");*/\\\\n\\\\n	return editor;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction findTagsInEditor(editor\\\",\\n	',',\\n	\\\"element)\\\\n{\\\\n	if (!editor.document) return;\\\\n	if (typeof editor.document.\\\\\\\$=='undefined') return;\\\\n	if (!editor.document.\\\\\\\$) return;\\\\n	\\\\n	var comcodes=get_elements_by_class_name(editor.document.\\\\\\\$.getElementsByTagName('body')[0]\\\",\\n	',',\\n	\\\"'(ocp_keep|ocp_keep_block|ocp_keep_real_block)');\\\\n\\\\n	for (var i=0;i<comcodes.length;i++)\\\\n	{\\\\n		if (!comcodes[i].onmouseout)\\\\n		{\\\\n			comcodes[i].orig_title=comcodes[i].title;\\\\n			comcodes[i].onmouseout=function(event) { \\\\n				if (!event) event=editor.window.\\\\\\\$.event;\\\\n\\\\n				var eventCopy={\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n				if (event)\\\\n				{\\\\n					if (event.pageX) eventCopy.pageX=3000;\\\\n					if (event.clientX) eventCopy.clientX=3000;\\\\n					if (event.pageY) eventCopy.pageY=3000;\\\\n					if (event.clientY) eventCopy.clientY=3000;\\\\n\\\\n					if (typeof window.deactivateTooltip!='undefined') deactivateTooltip(this\\\",\\n	',',\\n	\\\"eventCopy);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n			comcodes[i].onmousemove=function(event) {\\\\n				if (!event) event=editor.window.\\\\\\\$.event;\\\\n				\\\\n				var eventCopy={\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n				if (event)\\\\n				{\\\\n					if (event.pageX) eventCopy.pageX=3000;\\\\n					if (event.clientX) eventCopy.clientX=3000;\\\\n					if (event.pageY) eventCopy.pageY=3000;\\\\n					if (event.clientY) eventCopy.clientY=3000;\\\\n\\\\n					if (typeof window.activateTooltip!='undefined')\\\\n					{\\\\n						repositionTooltip(this\\\",\\n	',',\\n	\\\"eventCopy);\\\\n						this.title=this.orig_title;\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n			comcodes[i].onmousedown=function(event) {\\\\n				if (!event) event=editor.window.\\\\\\\$.event;\\\\n				\\\\n				if (event.altKey)\\\\n				{\\\\n					// Mouse cursor to start\\\\n					var range = selection.getRanges()[0];\\\\n					range.startOffset = 0;\\\\n					range.endOffset = 0;\\\\n					range.select()\\\\n					selection.selectRanges([range]);\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			if (comcodes[i].nodeName.toLowerCase()=='input')\\\\n			{\\\\n				comcodes[i].onmouseup=function(event) {\\\\n					var field_name=editor.name;\\\\n					if ((typeof window.event!='undefined') && (window.event)) window.event.returnValue=false;\\\\n					var block_name=this.title.replace(/\\\\\\\\[\\\\\\\\/block\\\\\\\\]\\\\\\\$/\\\",\\n	',',\\n	\\\"'').replace(/^.*\\\\\\\\]/\\\",\\n	',',\\n	\\\"'');\\\\n					if (this.id=='') this.id='block_'+Math.round(Math.random()*10000000);\\\\n					var url='\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT\\\",array(\\\"block_helper\\\")),\\n	\\\"?type=step2&block='+window.encodeURIComponent(block_name)+'&field_name='+field_name+'&parse_defaults='+window.encodeURIComponent(this.title)+'&save_to_id='+window.encodeURIComponent(this.id)+keep_stub();\\\\n					url=url+'&block_type='+(((field_name.indexOf('edit_panel_')==-1) && (window.location.href.indexOf(':panel_')==-1))?'main':'side');\\\\n					window.open(maintain_theme_in_link(url)\\\",\\n	',',\\n	\\\"''\\\",\\n	',',\\n	\\\"'width=750\\\",\\n	',',\\n	\\\"height=600\\\",\\n	',',\\n	\\\"status=no\\\",\\n	',',\\n	\\\"resizable=yes\\\",\\n	',',\\n	\\\"scrollbars=yes');\\\\n					return false;\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			comcodes[i].onmouseover=function(event) {\\\\n				if (!event) event=editor.window.\\\\\\\$.event;\\\\n				\\\\n				cancelBubbling(event);\\\\n\\\\n				if (typeof window.activateTooltip!='undefined')\\\\n				{\\\\n					var tag_text='';\\\\n					if (this.nodeName.toLowerCase()=='input')\\\\n					{\\\\n						tag_text=this.orig_title;\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n					{\\\\n						tag_text=getInnerHTML(this);\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					//if (tag_text.match(/^\\\\\\\\[.*\\\\\\\\]\\\\\\\$/))\\\\n					{\\\\n						this.style.cursor='pointer';\\\\n						\\\\n						var eventCopy={\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n						if (event)\\\\n						{\\\\n							if (event.pageX) eventCopy.pageX=3000;\\\\n							if (event.clientX) eventCopy.clientX=3000;\\\\n							if (event.pageY) eventCopy.pageY=3000;\\\\n							if (event.clientY) eventCopy.clientY=3000;\\\\n\\\\n							var self_ob=this;\\\\n							if ((typeof this.rendered_tooltip=='undefined') || (this.tag_text!=tag_text))\\\\n							{\\\\n								self_ob.is_over=true;\\\\n\\\\n								var request=load_XML_doc(maintain_theme_in_link('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT_NOHTTP\\\",array(\\\"comcode_convert\\\")),\\n	\\\"?css=1&javascript=1&box_title=\\\",\\n	ecv(\\\$cl,array(2,6),2,\\\"PREVIEW\\\",array()),\\n	\\\"'+keep_stub(false))\\\",\\n	',',\\n	\\\"function(ajax_result_frame\\\",\\n	',',\\n	\\\"ajax_result) {\\\\n									if (ajax_result)\\\\n									{\\\\n										var tmp_rendered=getInnerHTML(ajax_result);\\\\n										if (tmp_rendered.indexOf('\\\",\\n	ecv(\\\$cl,array(2),2,\\\"CCP_ERROR_STUB\\\",array()),\\n	\\\"')==-1)\\\\n											self_ob.rendered_tooltip=tmp_rendered;\\\\n									\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n									if (typeof self_ob.rendered_tooltip!='undefined')\\\\n									{\\\\n										self_ob.tag_text=tag_text;\\\\n										if (self_ob.is_over)\\\\n										{\\\\n											activateTooltip(self_ob\\\",\\n	',',\\n	\\\"eventCopy\\\",\\n	',',\\n	\\\"self_ob.rendered_tooltip\\\",\\n	',',\\n	\\\"'auto');\\\\n											self_ob.title=self_ob.orig_title;\\\\n										\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n									\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n								\\\",\\n	\\\"}\\\",\\n	',',\\n	\\\"'data='+window.encodeURIComponent('[semihtml]'+tag_text.replace(/<\\\\\\\\/?span[^>]*>/gi\\\",\\n	',',\\n	\\\"'')).substr(0\\\",\\n	',',\\n	\\\"1000)+'[/semihtml]');\\\\n							\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n							{\\\\n								activateTooltip(self_ob\\\",\\n	',',\\n	\\\"eventCopy\\\",\\n	',',\\n	\\\"self_ob.rendered_tooltip\\\",\\n	',',\\n	\\\"'400px');\\\\n							\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n						\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n					\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n				\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n// =============\\\\n// NORMAL EDITOR\\\\n// =============\\\\n\\\\nfunction is_comcode_xml(element)\\\\n{\\\\n	return (element.value.substr(0\\\",\\n	',',\\n	\\\"8)=='<comcode');\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction convert_xml(name)\\\\n{\\\\n	if (typeof window.load_XML_doc=='undefined') return false;\\\\n	if (typeof window.merge_text_nodes=='undefined') return false;\\\\n\\\\n	var element=document.getElementById(name);\\\\n\\\\n	if (isWYSIWYGField(element))\\\\n	{\\\\n		window.alert('\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"COMCODE_XML_CONVERT_NOT_WITH_WYSIWYG\\\",array()),\\n	\\\"');\\\\n		return false;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	var old_text=element.value;\\\\n	var request=load_XML_doc('\\\",\\n	ecv(\\\$cl,array(2),0,\\\"FIND_SCRIPT_NOHTTP\\\",array(\\\"comcode_convert\\\")),\\n	\\\"?to_comcode_xml=1'+keep_stub()\\\",\\n	',',\\n	\\\"false\\\",\\n	',',\\n	\\\"'data='+window.encodeURIComponent(old_text));\\\\n	var result=((request) && (request.responseXML) && (request.responseXML.documentElement))?request.responseXML.documentElement.getElementsByTagName(\\\\\\\"result\\\\\\\")[0]:null;\\\\n	if ((result) && (result.childNodes[0].data)) element.value=merge_text_nodes(result.childNodes);\\\\n	else\\\\n	{\\\\n		var error_window=window.open();\\\\n		error_window.document.write(request.responseText);\\\\n		error_window.document.close();\\\\n		window.alert('\\\",\\n	ecv(\\\$cl,array(8,2),2,\\\"COMCODE_XML_CONVERT_PARSE_ERROR\\\",array()),\\n	\\\"');\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	return false;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction do_emoticon(field_name\\\",\\n	',',\\n	\\\"p\\\",\\n	',',\\n	\\\"_opener)\\\\n{\\\\n	var element;\\\\n	if (_opener)\\\\n	{\\\\n		element=opener.document.getElementById(field_name);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		element=document.getElementById(field_name);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	element=ensure_true_id(element\\\",\\n	',',\\n	\\\"field_name);\\\\n\\\\n	var title=p.title;\\\\n	title=title.replace(/^.*: /\\\",\\n	',',\\n	\\\"'');\\\\n\\\\n	var text=is_comcode_xml(element)?('<emoticon>'+escape_html(title)+'</emoticon>'):(' '+title+' ');\\\\n\\\\n	if (_opener)\\\\n	{\\\\n		insertTextboxOpener(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"null\\\",\\n	',',\\n	\\\"true\\\",\\n	',',\\n	\\\"getInnerHTML(p));\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		insertTextbox(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"null\\\",\\n	',',\\n	\\\"true\\\",\\n	',',\\n	\\\"getInnerHTML(p));\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction do_attachment(field_name\\\",\\n	',',\\n	\\\"id\\\",\\n	',',\\n	\\\"description)\\\\n{\\\\n	if (!opener.areaedit_editors) return;\\\\n\\\\n	if (!description) description='';\\\\n\\\\n	var element=opener.document.getElementById(field_name);\\\\n	element=ensure_true_id(element\\\",\\n	',',\\n	\\\"field_name);\\\\n\\\\n	var comcode;\\\\n	if (!is_comcode_xml(element))\\\\n	{\\\\n		comcode='\\\\\\\\n\\\\\\\\n[attachment type=\\\\\\\"island\\\\\\\" description=\\\\\\\"'+escape_comcode(description)+'\\\\\\\"]'+id+'[/attachment]';\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		comcode='<br /><br /><attachment type=\\\\\\\"island\\\\\\\"><attachmentDescription>'+description+'</attachmentDescription>'+id+'</attachment>';\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	insertTextboxOpener(element\\\",\\n	',',\\n	\\\"comcode);\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction ensure_true_id(element\\\",\\n	',',\\n	\\\"field_name) // Works around IE bug\\\\n{\\\\n	var form=element.form;\\\\n	var i;\\\\n	for (i=0;i<form.elements.length;i++)\\\\n	{\\\\n		if ((form.elements[i].id==field_name)/* || (form.elements[i].name==field_name)*/)\\\\n		{\\\\n			return form.elements[i];\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	return element;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction isWYSIWYGField(theElement)\\\\n{\\\\n	return ((typeof window.areaedit_editors!='undefined') && (theElement.id!='length') && (typeof areaedit_editors[theElement.id]!='undefined'));\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction getTextbox(element)\\\\n{\\\\n	if (isWYSIWYGField(element))\\\\n	{\\\\n		var ret=areaedit_editors[element.id].getData();\\\\n		if ((ret==\\\\\\\"\\\\\\\\n\\\\\\\") || (ret==\\\\\\\"<br />\\\\\\\")) ret=\\\\\\\"\\\\\\\";\\\\n		return ret;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	return element.value;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction setTextbox(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"html)\\\\n{\\\\n	if (isWYSIWYGField(element))\\\\n	{\\\\n		if (!html) html=escape_html(text).replace(new RegExp('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n'\\\",\\n	',',\\n	\\\"'gi')\\\",\\n	',',\\n	\\\"'<br />');\\\\n\\\\n		areaedit_editors[element.id].setData(html);\\\\n		fixImagesIn(areaedit_editors[element.id].document.getBody());\\\\n\\\\n		window.setTimeout(function() {\\\\n			findTagsInEditor(areaedit_editors[element.id]\\\",\\n	',',\\n	\\\"element);\\\\n		\\\",\\n	\\\"}\\\",\\n	',',\\n	\\\" 100);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	element.value=text;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction insertTextbox(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"sel\\\",\\n	',',\\n	\\\"plain_insert\\\",\\n	',',\\n	\\\"html)\\\\n{\\\\n	if (isWYSIWYGField(element))\\\\n	{\\\\n		var insert='';\\\\n		if (plain_insert)\\\\n		{\\\\n			insert=getSelectedHTML(areaedit_editors[element.id])+(html?html:escape_html(text).replace(new RegExp('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n'\\\",\\n	',',\\n	\\\"'gi')\\\",\\n	',',\\n	\\\"'<br />'));\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n		{\\\\n			var matches=text.match(/^\\\\\\\\s*\\\\\\\\[block(.*)\\\\\\\\](.*)\\\\\\\\[\\\\\\\\/block\\\\\\\\]\\\\\\\\s*\\\\\\\$/);\\\\n			if (matches)\\\\n			{\\\\n				insert=getSelectedHTML(areaedit_editors[element.id])+\\\\n					('<input class=\\\\\\\"ocp_keep_real_block\\\\\\\" title=\\\\\\\"'+(html?matches[0].replace(/^\\\\\\\\s*/\\\",\\n	',',\\n	\\\"'').replace(/\\\\\\\\s*\\\\\\\$/\\\",\\n	',',\\n	\\\"''):escape_html(matches[0].replace(/^\\\\\\\\s*/\\\",\\n	',',\\n	\\\"'').replace(/\\\\\\\\s*\\\\\\\$/\\\",\\n	',',\\n	\\\"'')))+'\\\\\\\" type=\\\\\\\"button\\\\\\\" value=\\\\\\\"'+('\\\",\\n	ecv(\\\$cl,array(2,1),2,\\\"comcode:COMCODE_EDITABLE_BLOCK\\\",array()),\\n	\\\"'.replace('{1}'\\\",\\n	',',\\n	\\\"matches[2]))+'\\\\\\\" />');\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				var tag_name=text.replace(/^\\\\\\\\[/\\\",\\n	',',\\n	\\\"'').replace(/[ \\\\\\\\]].*\\\\\\\$/\\\",\\n	',',\\n	\\\"'');\\\\n				insert=getSelectedHTML(areaedit_editors[element.id])+\\\\n					('<span title=\\\\\\\"'+(html?tag_name:escape_html(tag_name))+'\\\\\\\" class=\\\\\\\"ocp_keep\\\\\\\">')+\\\\n					(html?html:escape_html(text).replace(new RegExp('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n'\\\",\\n	',',\\n	\\\"'gi')\\\",\\n	',',\\n	\\\"'<br />'))+\\\\n					'</span> ';\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		areaedit_editors[element.id].focus();\\\\n		try\\\\n		{\\\\n			var before=areaedit_editors[element.id].getData();\\\\n			areaedit_editors[element.id].insertHtml(insert);\\\\n			var after=areaedit_editors[element.id].getData();\\\\n			if (after==before) throw \\\\\\\"Failed to insert\\\\\\\";\\\\n			findTagsInEditor(areaedit_editors[element.id]\\\",\\n	',',\\n	\\\"element);\\\\n			fixImagesIn(areaedit_editors[element.id].document.getBody());\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		catch (e) // Sometimes happens on Firefox in Windows\\\",\\n	',',\\n	\\\" appending is a bit tamer (e.g. you cannot insert if you have the start of a h1 at cursor)\\\\n		{\\\\n			if (areaedit_editors[element.id].document)\\\\n			{\\\\n				setInnerHTML(areaedit_editors[element.id].document.getBody().\\\\\\\$\\\",\\n	',',\\n	\\\"insert\\\",\\n	',',\\n	\\\"true);\\\\n				findTagsInEditor(areaedit_editors[element.id]\\\",\\n	',',\\n	\\\"element);\\\\n				fixImagesIn(areaedit_editors[element.id].document.getBody());\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n			{\\\\n				areaedit_editors[element.id].textarea.\\\\\\\$.value+=text;\\\\n			\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		return;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	var from=element.value.length\\\",\\n	',',\\n	\\\"to;\\\\n\\\\n	element.focus();\\\\n\\\\n	if (!sel) sel=document.selection?document.selection:null;\\\\n\\\\n	if (typeof element.selectionEnd!='undefined') // Mozilla style\\\\n	{\\\\n		from=element.selectionStart;\\\\n		to=element.selectionEnd;\\\\n\\\\n		var start=element.value.substring(0\\\",\\n	',',\\n	\\\"from);\\\\n		var end=element.value.substring(to\\\",\\n	',',\\n	\\\"element.value.length);\\\\n\\\\n		element.value=start+element.value.substring(from\\\",\\n	',',\\n	\\\"to)+text+end;\\\\n		setSelectionRange(element\\\",\\n	',',\\n	\\\"from+text.length\\\",\\n	',',\\n	\\\"from+text.length);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	if (sel) // IE style\\\\n	{\\\\n		var ourRange=sel.createRange();\\\\n		if ((ourRange.moveToElementText) || (ourRange.parentElement()==element))\\\\n		{\\\\n			if (ourRange.parentElement()!=element) ourRange.moveToElementText(element);\\\\n			ourRange.text=ourRange.text+text;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n		{\\\\n			element.value+=text;\\\\n			from+=2;\\\\n			setSelectionRange(element\\\",\\n	',',\\n	\\\"from+text.length\\\",\\n	',',\\n	\\\"from+text.length);\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	else\\\\n	{\\\\n		// :(\\\\n		from+=2;\\\\n		element.value+=text;\\\\n		setSelectionRange(element\\\",\\n	',',\\n	\\\"from+text.length\\\",\\n	',',\\n	\\\"from+text.length);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\nfunction insertTextboxOpener(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"sel\\\",\\n	',',\\n	\\\"plain_insert\\\",\\n	',',\\n	\\\"html)\\\\n{\\\\n	if (!sel) sel=opener.document.selection?opener.document.selection:null;\\\\n\\\\n	opener.insertTextbox(element\\\",\\n	',',\\n	\\\"text\\\",\\n	',',\\n	\\\"sel\\\",\\n	',',\\n	\\\"plain_insert\\\",\\n	',',\\n	\\\"html);\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction getSelectedHTML(editor)\\\\n{\\\\n	var mySelection=editor.getSelection();\\\\n	if (!mySelection || mySelection.getType()==CKEDITOR.SELECTION_NONE) return '';\\\\n\\\\n	var selectedText='';\\\\n	if (CKEDITOR.env.ie)\\\\n	{\\\\n		mySelection.unlock(true);\\\\n		selectedText=mySelection.getNative().createRange().htmlText;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	{\\\\n		try\\\\n		{\\\\n			selectedText=getInnerHTML(mySelection.getNative().getRangeAt(0).cloneContents());\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		catch (e) {\\\",\\n	\\\"}\\\",\\n	\\\";\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	return selectedText;\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\nfunction insertTextboxWrapping(element\\\",\\n	',',\\n	\\\"beforeWrapTag\\\",\\n	',',\\n	\\\"afterWrapTag)\\\\n{\\\\n	var from\\\",\\n	',',\\n	\\\"to;\\\\n\\\\n	if (afterWrapTag==\\\\\\\"\\\\\\\")\\\\n	{\\\\n		if (!is_comcode_xml(element))\\\\n		{\\\\n			afterWrapTag=\\\\\\\"[/\\\\\\\"+beforeWrapTag+\\\\\\\"]\\\\\\\";\\\\n			beforeWrapTag=\\\\\\\"[\\\\\\\"+beforeWrapTag+\\\\\\\"]\\\\\\\";\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n		{\\\\n			afterWrapTag=\\\\\\\"</\\\\\\\"+beforeWrapTag+\\\\\\\">\\\\\\\";\\\\n			beforeWrapTag=\\\\\\\"<\\\\\\\"+beforeWrapTag+\\\\\\\">\\\\\\\";\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	if (isWYSIWYGField(element))\\\\n	{\\\\n		if (!browser_matches('opera')) areaedit_editors[element.id].focus(); // Needed on some browsers\\\",\\n	',',\\n	\\\" but on Opera will defocus our selection\\\\n		var selectedHTML=getSelectedHTML(areaedit_editors[element.id]);\\\\n		if (browser_matches('opera')) areaedit_editors[element.id].getSelection().getNative().getRangeAt(0).deleteContents();\\\\n		areaedit_editors[element.id].insertHtml('<span title=\\\\\\\"'+escape_html(beforeWrapTag.replace(/^\\\\\\\\[/\\\",\\n	',',\\n	\\\"'').replace(/[ \\\\\\\\]].*\\\\\\\$/\\\",\\n	',',\\n	\\\"''))+'\\\\\\\" class=\\\\\\\"ocp_keep\\\\\\\">'+beforeWrapTag+selectedHTML+afterWrapTag+'</span> ');\\\\n		fixImagesIn(areaedit_editors[element.id].document.getBody());\\\\n		findTagsInEditor(areaedit_editors[element.id]\\\",\\n	',',\\n	\\\"element);\\\\n		return;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n	if (typeof element.selectionEnd!='undefined') // Mozilla style\\\\n	{\\\\n		from=element.selectionStart;\\\\n		to=element.selectionEnd;\\\\n\\\\n		var start=element.value.substring(0\\\",\\n	',',\\n	\\\"from);\\\\n		var end=element.value.substring(to\\\",\\n	',',\\n	\\\"element.value.length);\\\\n\\\\n		if (to>from)\\\\n		{\\\\n			element.value=start+beforeWrapTag+element.value.substring(from\\\",\\n	',',\\n	\\\"to)+afterWrapTag+end;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n		{\\\\n			element.value=start+beforeWrapTag+afterWrapTag+end;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n		setSelectionRange(element\\\",\\n	',',\\n	\\\"from\\\",\\n	',',\\n	\\\"to+beforeWrapTag.length+afterWrapTag.length);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else\\\\n	if (typeof document.selection!='undefined') // IE style\\\\n	{\\\\n		element.focus();\\\\n		var sel=document.selection;\\\\n		var ourRange=sel.createRange();\\\\n		if ((ourRange.moveToElementText) || (ourRange.parentElement()==element))\\\\n		{\\\\n			if (ourRange.parentElement()!=element) ourRange.moveToElementText(element);\\\\n			ourRange.text=beforeWrapTag+ourRange.text+afterWrapTag;\\\\n		\\\",\\n	\\\"}\\\",\\n	\\\" else element.value+=beforeWrapTag+afterWrapTag;\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	else\\\\n	{\\\\n		// :(\\\\n		element.value+=beforeWrapTag+afterWrapTag;\\\\n		setSelectionRange(element\\\",\\n	',',\\n	\\\"from\\\",\\n	',',\\n	\\\"to+beforeWrapTag.length+afterWrapTag.length);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n\\\\n// From http://www.faqts.com/knowledge_base/view.phtml/aid/13562\\\\nfunction setSelectionRange(input\\\",\\n	',',\\n	\\\"selectionStart\\\",\\n	',',\\n	\\\"selectionEnd)\\\\n{\\\\n	if (typeof input.setSelectionRange!='undefined') /* Mozilla style */\\\\n	{\\\\n		input.focus();\\\\n		input.setSelectionRange(selectionStart\\\",\\n	',',\\n	\\\"selectionEnd);\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	else if (typeof input.createTextRange!='undefined') /* IE style */\\\\n	{\\\\n		var range=input.createTextRange();\\\\n		range.collapse(true);\\\\n		range.moveEnd('character'\\\",\\n	',',\\n	\\\"selectionEnd);\\\\n		range.moveStart('character'\\\",\\n	',',\\n	\\\"selectionStart);\\\\n		range.select();\\\\n	\\\",\\n	\\\"}\\\",\\n	\\\" else input.focus();\\\\n\\\",\\n	\\\"}\\\",\\n	\\\"\\\\n	  \\\\n\\\";\";\n\";}");

?>